# 步进电机

本文记录学习步进电机原理的过程，建议拆开一个常见的42步进电机，可以更好地帮助理解。

另外，本次过程中，没有一个42步进电机受到伤害。

# 1 组成

42步进电机从左到右依次为盖子、轴承、转子、轴承、定子。

![Untitled](%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%2041b355b3ab4b4fd791c94ea37ca9f448/Untitled.png)

转子——通常为永磁体

![Untitled](%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%2041b355b3ab4b4fd791c94ea37ca9f448/Untitled%201.png)

定子——通常为线圈绕组

![Untitled](%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%2041b355b3ab4b4fd791c94ea37ca9f448/Untitled%202.png)

# 2 原理

## 2.1 最基本理论

![Untitled](%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%2041b355b3ab4b4fd791c94ea37ca9f448/Untitled%203.png)

通电螺线管如图所示可以产生磁场。

![Untitled](%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%2041b355b3ab4b4fd791c94ea37ca9f448/Untitled%204.png)

相对的两级为一组，如图所示姑且将他称为AA-线圈和BB-线圈，可以产生一极为N，另一极为S的磁场（绕法不同，也有可能出现两极都为N的情况）。并且通反向电流磁极也相反，姑且将他们分别称为正向电流和反向电流。

第1秒：AA-线圈同正向电流，BB-线圈不通电，磁场方向和转子位置如图(a)。

第2秒：AA-线圈和BB-线圈都通正向电流，形成了合磁场，磁场方向和转子位置如图(b)。PS：第2秒电机的转子转动了45°，并且由受力关系可知，它只能沿顺时针方向转动。

第3秒：AA-线圈不通电，BB-线圈同反向电流，磁场方向和转子位置如图(c)。

第4秒：AA-线圈和BB-线圈都通反向电流，形成了合磁场，磁场方向和转子位置如图(d)。

第5秒：……

![0FFBB47BC3889813F2C69B964537DA55.png](%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%2041b355b3ab4b4fd791c94ea37ca9f448/0FFBB47BC3889813F2C69B964537DA55.png)

完整过程如图所示。

![77271436057B39FD8E68F0E63A6D152C.png](%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%2041b355b3ab4b4fd791c94ea37ca9f448/77271436057B39FD8E68F0E63A6D152C.png)

波形长这样。

总结一下，这个最基本的原理构成的步进电机，步进角45°（这也太垃圾了），而且触发脉冲分布不均匀（长得也太丑了）要做出这种奇奇怪怪的脉冲，需要相当复杂的电路，显然不符合通用性的原则。

## 2.2 进阶原理

直接上一个比较常用的两相步进电机，步进角1.8°，PM(Permanent Magnet)永久磁体型；

定子有8个极，每个极6个齿；

转子有50个齿。

首先解释几个名词

相：

![Untitled](%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%2041b355b3ab4b4fd791c94ea37ca9f448/Untitled%205.png)

这个很明显，是一相，一个线圈做成的电磁铁，很好理解。

![Untitled](%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%2041b355b3ab4b4fd791c94ea37ca9f448/Untitled%206.png)

这个是两相，相对的两个组成一组，有两个独立的线圈，做成两个独立的电磁铁。同时刚刚在最基本原理里举的例子也是两相的。

但是为了提高性能，有一些小操作，将这个两项，改成这个样子：

![Untitled](%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%2041b355b3ab4b4fd791c94ea37ca9f448/Untitled%207.png)

这就引出了极的概念。

相通常用ABCD等字母表示。

极：

就是数个数，改之前是四极，改之后是八极，你应该能够想象的到，这样改进的后果就是，提高控制精度。虽然有四组极 ，但是它只由两个独立的线圈来控制，一个线圈缠绕在四个极上。

齿：

拆开步进电机，数就完了，没什么好解释的。

拍：

其中线圈，通电断电一次，就是一拍。

单拍就是同一个通断电周期时间内，只用一个线圈通电断电。

双拍就是同一个同断电周期时间内，有两个线圈通电断电。

三拍同理。

让后你就可以进行自由的组合，单三拍，单双拍，双三拍，混合模式的六拍（A—AB—B—BC—C—CA—A）等等。

当然双一拍肯定就不存在了。

总结一下：相 极 都是硬件条件，拍是工作模式，我最开始图片中的那个是一个双相八级步进电机，可以工作在单拍模式下，或者双拍模式下，或者混合拍子。

需要知道这些参数，原因是步进电机的一个比较重要的参数，步进角与这些参数有关。

步进角：

$θ=360°/(mZk)$

其中，

m是相数，

Z是转子齿数

k是通电方式，也就是拍（单三拍、双三拍，k都等于3）

$1.8°=360°/(2*50*4)$——（对于两相或者四相步进电机来说，四拍通常称为整步，八拍通常称为半步）

接下来来解释为什么是这个公式

如图所示的定子和转子：

![79D80BAB41EF5624D8F24571F83A2148.png](%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%2041b355b3ab4b4fd791c94ea37ca9f448/79D80BAB41EF5624D8F24571F83A2148.png)

![7E9F32A99CF4F5513B2FCE8DE86A3980.png](%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%2041b355b3ab4b4fd791c94ea37ca9f448/7E9F32A99CF4F5513B2FCE8DE86A3980.png)

![Untitled](%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%2041b355b3ab4b4fd791c94ea37ca9f448/Untitled%208.png)

可以看出他们的间距有细微的区别，被分成了如图所示的八组，也就是八极，极与极之间的间距略大。

具体数据是：

可以计算出转子上的齿距是360/50=7.2 那么定子一极中的齿也按7.2°装六个磁铁，八个极均匀分布，极与极之间的分布比7.2°略大，这样做地好处就是，当一组对齐的时候，另外两组就错开了，其中间隔一组的错开半个位置。

![Untitled](%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%2041b355b3ab4b4fd791c94ea37ca9f448/Untitled%209.png)

四相四拍：

先假设这是一个四相步进电机，相对的两极为一相，经过四拍，也就是A-B-C-D这样的顺序依次通电后，会导致按如图所示的红圈顺序使得转子和定子对齐，四次对齐后，可以观察到，小三角形标记的内齿，前进一个齿的距离。

![F02B199A1B46A181880C28D28FCAD113.png](%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%2041b355b3ab4b4fd791c94ea37ca9f448/F02B199A1B46A181880C28D28FCAD113.png)

这样就可以得出结论：

360°中内齿总共有50个，每四拍前进一个齿的距离，360/50/4=1.8。

这个也就是为什么四拍被称为整步，而半步是什么呢？还记得在最基本原理中讲过的合磁场的情况吗？

如果同时有两个相邻的线圈通电，就会在四拍的工作模式的拍与拍之间的中间位置，再插入一拍，变为八拍，步进角变为1.8/2=0.9。

> 这里引用百度百科的解释，当两相控制绕组按AA BB或BB AA的次序轮流通电，侮拍只有一相绕组通电，四拍构成一个循环。当控制绕组有电流通过时，便产生磁动势，它与永久磁钢产生的磁动势相互作用，产生电磁转知，使转子产生步进运动。
当A相绕组通电时，在转子N极端磁极1上的绕组产生的S磁极吸引转子N极，使得磁极1下是齿对齿，磁力线由转子N极指向磁极1的齿面，磁极5下也是齿对齿，磁极3和7是齿对槽。由于两段转子铁芯上的小齿相互错开半个齿距，在转子S极端，磁极1'和5’产生的S极磁场，排斥转子S极，与转子正好是齿对槽，磁极3’和7’齿面产生N极磁场，吸引转子S极，使得齿对齿。
> 
> 
> [二相混合式步进电机_百度百科](https://baike.baidu.com/item/%E4%BA%8C%E7%9B%B8%E6%B7%B7%E5%90%88%E5%BC%8F%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA/21512187#reference-[2]-22162895-wrap)
> 
> ![Untitled](%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%2041b355b3ab4b4fd791c94ea37ca9f448/Untitled%2010.png)
> 

两相四拍：

那么两相的步进电机怎么进行四拍呢

![Untitled](%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%2041b355b3ab4b4fd791c94ea37ca9f448/Untitled%2011.png)

注意观察图中的黑线和白线，他们是相互错开的，也就是说，一个转子上的磁铁分为四层，1、3层是N极，2、4层是S极，每一层各自由50个，可以独立工作，N极层和S极层错开7.2/2=3.6°。

![Untitled](%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%2041b355b3ab4b4fd791c94ea37ca9f448/Untitled%2012.png)

![Untitled](%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%2041b355b3ab4b4fd791c94ea37ca9f448/Untitled%2013.png)

将模型修改为如图所示，其中橙色为N极，绿色为S极，

![Untitled](%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%2041b355b3ab4b4fd791c94ea37ca9f448/Untitled%2014.png)

将红框线圈绑定为同一个线圈，做A相，将黑框线圈绑定为另一个线圈，做B相。

1号位置的线圈通电和2号位置通电磁场相位呈180°相位差。

第一拍：

1号位置：呈N极，吸引绿色齿轮，相邻两个N极排斥橙色齿轮。

2号位置，呈S极，吸引橙色齿轮，相邻两个S极排斥绿色齿轮。

![1号位置：](%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%2041b355b3ab4b4fd791c94ea37ca9f448/Untitled%2015.png)

1号位置：

![2号位置：](%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%2041b355b3ab4b4fd791c94ea37ca9f448/Untitled%2016.png)

2号位置：

第二拍：

3号位置：呈N极，吸引绿色齿轮，相邻两个N极排斥橙色齿轮，合力使得转子顺时针方向转动。

4号位置：呈S极，吸引橙色齿轮，相邻两个S极排斥绿色齿轮，合力使得转子顺时针方向转动。

![3号位置：](%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%2041b355b3ab4b4fd791c94ea37ca9f448/Untitled%2017.png)

3号位置：

![4号位置：](%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%2041b355b3ab4b4fd791c94ea37ca9f448/Untitled%2018.png)

4号位置：

至此就可以得出二相四拍的工作过程：A+ B+ A- B-

![19EA3738B0C96939F86C4F1D1D4FA09B.png](%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%2041b355b3ab4b4fd791c94ea37ca9f448/19EA3738B0C96939F86C4F1D1D4FA09B.png)

至此，基于最基本原理改进而来的步进电机，终于有了较高的步进精度，具有了一定的使用价值。

## 2.3 细分原理

先说结论，细分控制使得步进电机的运动更加平滑，虽然理论上减小了步进角度，但这个步进电机不能完全准确地执行这个步进角度，事实上，精度并没有提高。

细分数越高，相同频率输入脉冲的情况下，速度越慢，运动越平滑。

例如在128细分下，细分步进电机驱动每获得128个脉冲信号，细分步进电机驱动驱动步进电机前进1.8°。

这是一个步进电机驱动器的原理框图。

![Untitled](%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%2041b355b3ab4b4fd791c94ea37ca9f448/Untitled%2019.png)

驱动器工作时，可以简化为如图所示的电路图。

![Untitled](%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%2041b355b3ab4b4fd791c94ea37ca9f448/Untitled%2020.png)

在线圈两端加上一定的电压，如下等式成立，

![Untitled](%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%2041b355b3ab4b4fd791c94ea37ca9f448/Untitled%2021.png)

解得，

![Untitled](%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%2041b355b3ab4b4fd791c94ea37ca9f448/Untitled%2022.png)

这是一阶系统的单位阶跃响应。

A相和B相的输入曲线和输出曲线分别是图中的绿色实线和红色虚线。

输入输出曲线是在电机不转动的情况下的理论情况，在实际工作过程中，电机转动，通过线圈的实际电流的曲线是途中黑色的曲线。

![Untitled](%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%2041b355b3ab4b4fd791c94ea37ca9f448/Untitled%2023.png)

而电机的扭矩和流过电机线圈的电流大小正相关，因此抖动的电流大小必然导致电机转动过程中出现抖动。

> 这个也就是为什么四拍被称为整步，而半步是什么呢？还记得在最基本原理中讲过的合磁场的情况吗？
> 

引用曾经讲过的整部半步的概念，其中有一个将整部变为半步，1.8步进精度变为0.9步进精度的描述，有一个合磁场的概念，如果A相同电的同时B相也通电，就会在四排的拍和拍之间插入一拍，这里所述的合磁场是A相B相上通相同大小的电流，那如果在将这一情况再细分。

![94372D4E97A69723C6FF3A460D5657C8.png](%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%2041b355b3ab4b4fd791c94ea37ca9f448/94372D4E97A69723C6FF3A460D5657C8.png)

按表格所示的顺序进行通电，就在四拍的拍与拍之间插入了四种状态，电流如果持续保持这种状态，就会实现更高精度的细分。

（暂且这么描述，但是细分是无法实现更高细分的，具体解释见下文）

|  | A相 | B相 |
| --- | --- | --- |
| 0 | 100% | 0% |
| 1 | 80% | 20% |
| 2 | 60% | 40% |
| 3 | 40% | 60% |
| 5 | 20% | 80% |
| 6 | 0% | 100% |

将表格描述成图片，并且递增递减量采用更加平滑的正弦曲线，就变成了如下图所示的信号。

![Untitled](%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%2041b355b3ab4b4fd791c94ea37ca9f448/Untitled%2024.png)

如图所示，黑色是理论的输入阶跃曲线，红色是最理想的细分目标曲线，当细分数越大，蓝色曲线的台阶数就越大，（在四拍动作的拍与拍之间插入的中间状态就越多，控制就越平滑）。

![BF8B11D74D1678734C8966A4CEFAB27D.png](%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%2041b355b3ab4b4fd791c94ea37ca9f448/BF8B11D74D1678734C8966A4CEFAB27D.png)

平滑的原因：

输入曲线就是要达成的目标，如果设置目标是第一拍，第二拍，电机只需要在对的时间动到对的拍子上就行了，至于它是怎么动过去的，跳着过去还是平滑着过去的，就不知道了，根据上面的图可知，显然电机是跳着过去的。

但是如果在第一拍和第二拍中间加入1.1拍、1.2拍、1.3拍……将电机的目标进一步细分，告诉电机你不能跳着走，要根据一条平滑的曲线走，电机在1.1拍到1.2拍还会存在跳动，但是跳动的幅度就更小了。

为什么不能提高精度：

贴一个CSDN的解释，具体原因要分析细分电路的工作原理。

> 很多用户误以为步进电机驱动器的细分越高，步进电机的精度就越高，其实这是一种错误的观念，比如步进电机驱动器细分较高的可以达到60000个脉冲一转，而步进电机实际是无法分辨这个精度的，当驱动器设置为60000个脉冲/转的时候，步进电机驱动器接受好几个脉冲，步进电机才走一步，这样并不能提高步进电机的精度。
> 
> 
> 步进电机的细分技术实质上是一种电子阻尼技术，其主要目的是减弱或消除步进电机的低频振动，提高电机的运转精度只是细分技术的一个附带功能。细分后电机运行时的实际步距角是基本步距角的几分之一。（两相步进电机的基本步距角是1.8°，即一个脉冲走1.8°，如果没有细分，则是200个脉冲走一圈360°，细分是通过驱动器靠精确控制电机的相电流所产生的，与电机无关，如果是10细分，则发一个脉冲电机走0.18°，即2000个脉冲走一圈360°，电机的精度能否达到或接近0.18°，还取决于细分驱动器的细分电流控制精度等其它因素。不同厂家的细分驱动器精度可能差别很大；细分数越大精度越难控制。以次类推。三相步进电机的基本步距角是1.2°，即一个脉冲走1.2°，如果没有细分，则是300个脉冲走一圈360°，如果是10细分，则发一个脉冲，电机走0.12°，即3000个脉冲走一圈360°，以次类推。在电机实际使用时，如果对转速要求较高，且对精度和平稳性要求不高的场合，不必选高细分。在实际使用时，如果转速很低情况下，应该选大细分，确保平滑，减少振动和噪音。）
> 
> [步进电机的细分控制原理_学海无涯-CSDN博客_步进电机细分](https://blog.csdn.net/qq_30567891/article/details/78302278)
>